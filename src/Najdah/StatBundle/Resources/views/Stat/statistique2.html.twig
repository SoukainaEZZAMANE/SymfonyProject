{% extends "::layout.html.twig" %}

{% block title %}Acceuil - {{ parent() }}{% endblock %}

{% block menu_Acceuil %}<span class="selected"></span>{% endblock %}
{% block menu_Acceuil_active %}active{% endblock %}

{% block body_app %}
    {# --------------------------------barre en haut d'accueil--------------------------------- #}
    <div class="row-fluid">
        <div class="span12">
            <!-- END BEGIN STYLE CUSTOMIZER -->
            <!-- BEGIN PAGE TITLE & BREADCRUMB-->
            <h3 class="page-title">
                BackOffice Najdah <small>page d'accueil</small>
            </h3>
            <ul class="breadcrumb">
                <li>
                    <i class="icon-home"></i>
                    <a href="{{ path('app_acceuil') }}">Najdah</a>
                    <i class="icon-angle-right"></i>
                </li>
                <li><a href="{{ path('app_acceuil') }}"></a>Accueil</li>
                <li class="pull-right no-text-shadow">
                    <div id="dashboard-report-range" class="dashboard-date-range tooltips no-tooltip-on-touch-device responsive" data-tablet="" data-desktop="tooltips" data-placement="top" data-original-title="Change dashboard date range">
                        <i class="icon-calendar"></i>
                        <span></span>
                        <i class="icon-angle-down"></i>
                    </div>
                </li>
            </ul>
            <!-- END PAGE TITLE & BREADCRUMB-->
        </div>
    </div>
    {# --------------------------------fin barre en haut d'accueil--------------------------------- #}
    <div id="dashboard">
        <div class="row-fluid">
            <div class="span3 responsive" data-tablet="span6" data-desktop="span3">
                <div class="dashboard-stat blue">
                    <div class="visual">
                        <i class="icon-user"></i>
                    </div>
                    <div class="details">
                        <div class="number">
                            {{ nbrAllCitoyen }}
                        </div>
                        <div class="desc">
                            Utilisateurs
                        </div>
                    </div>
                    <a class="more" href="#">
                        détails <i class="m-icon-swapright m-icon-white"></i>
                    </a>
                </div>
            </div>
            <div class="span3 responsive" data-tablet="span6" data-desktop="span3">
                <div class="dashboard-stat red">
                    <div class="visual">
                        <i class="icon-envelope icon-white"></i>
                    </div>
                    <div class="details">
                        <div class="number">{{ nbrAllDec }}</div>
                        <div class="desc">Déclarations</div>
                    </div>
                    <a class="more" href="#">
                        Détails <i class="m-icon-swapright m-icon-white"></i>
                    </a>
                </div>
            </div>
            <div class="span3 responsive" data-tablet="span6  fix-offset" data-desktop="span3">
                <div class="dashboard-stat purple">
                    <div class="visual">
                        <i class="icon-map-marker"></i>
                    </div>
                    <div class="details">
                        <div class="number">Maps</div>
                        <div class="desc">Infrastructure</div>
                    </div>
                    <a class="more" href="#">
                        Détails <i class="m-icon-swapright m-icon-white"></i>
                    </a>
                </div>
            </div>
            <div class="span3 responsive" data-tablet="span6" data-desktop="span3">
                <div class="dashboard-stat yellow">
                    <div class="visual">
                        <i class="icon-bar-chart"></i>
                    </div>
                    <div class="details">
                        <div class="number">Tous</div>
                        <div class="desc">Statistiques</div>
                    </div>
                    <a class="more" href="#">
                        Détails <i class="m-icon-swapright m-icon-white"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    {# --------------------------------------- end box echantillonage ------------------------------------------------#}

    {#---------------------------------------- début des statistique -------------------------------------------------#}
    <div class="clearfix"></div>
    <div class="row-fluid">
        <div class="span6">
            <!-- BEGIN PORTLET-->
            <div class="portlet solid bordered light-grey">
                <div class="portlet-title">
                    <div class="caption"><i class="icon-bar-chart"></i>Déclaration par mois/ville</div>
                    <div class="tools">
                        <div class="btn-group pull-right" data-toggle="buttons-radio">
                            <a href="" class="btn mini">Users</a>
                            <a href="" class="btn mini active">Feedbacks</a>
                        </div>
                    </div>
                </div>
{#------------------------------date picker pour la date (mois des déclarations---------------------------------------------#}
               {# <div class="control-group">
                    <label class="control-label">Choisisez une date</label>
                    <div class="controls">
                        <div class="input-append date form_datetime">
{#------------------------------- zone de text de la date ---------------------------------------------------
                            <input id="choice-dateDec" size="16" type="text" value="" readonly class="m-wrap">
                            <span class="add-on"><i class="icon-calendar"></i></span>
                        </div>
                    </div>
                </div>#}
                <div id="containerStat"  class="portlet-body" style="height: 300px">

                   {# {{ statistiqueVille[1]['libelle'] }} => {{  statistiqueVille[1]['nbr'] }}
                    {{ dump(statistiqueVille) }} #}

                </div>
            </div>
            <!-- END PORTLET-->
        </div>
        <div class="span6">
            <!-- BEGIN PORTLET-->
            <div class="portlet solid light-grey bordered">
                <div class="portlet-title">
                    <div class="caption"><i class="icon-bullhorn"></i>Traitement des déclaration</div>
                    <div class="tools">
                        <div class="btn-group pull-right" data-toggle="buttons-radio">
                            <a href="" class="btn blue mini active">Users</a>
                            <a href="" class="btn blue mini">Orders</a>
                        </div>
                    </div>
                </div>
                <div class="portlet-body">
                    <div id="site_statistics_loading">
                        <img src="{{ asset('assets/img/loading.gif') }}" alt="loading" />
                    </div>
                    <div id="site_statistics_content" class="hide">
                        <div id="site_statistics" class="chart"></div>
                    </div>
                </div>
            </div>
            <!-- END PORTLET-->
            <!-- BEGIN PORTLET-->
   {#        <div class="portlet solid bordered light-grey">
                <div class="portlet-title">
                    <div class="caption"><i class="icon-signal"></i>Server Load</div>
                    <div class="tools">
                        <div class="btn-group pull-right" data-toggle="buttons-radio">
                            <a href="" class="btn red mini active">
                                <span class="hidden-phone">Database</span>
                                <span class="visible-phone">DB</span></a>
                            <a href="" class="btn red mini">Web</a>
                        </div>
                    </div>
                </div>
                <div class="portlet-body">
                    <div id="load_statistics_loading">
                        <img src="assets/img/loading.gif" alt="loading" />
                    </div>
                    <div id="load_statistics_content" class="hide">
                        <div id="load_statistics" style="height:108px;"></div>
                    </div>
                </div>
            </div> #}
            <!-- END PORTLET-->
        </div>
    </div>

    {#---------------------------------End statistique--------------------------------------#}

    <script src="{{ asset('assets/rsone-statistique/jquery-1.8.2.min.js') }}" type="application/javascript"></script>
    <script src="{{ asset('assets/rsone-statistique/morris.min.js') }}" type="application/javascript"></script>
    <script src="{{ asset('assets/rsone-statistique/raphael-2.1.0.min.js') }}" type="application/javascript"></script>

    <script type="application/javascript" >

        var StatVille= '{{(statistiqueVille|json_encode|raw)}}';
        var donnee=JSON.parse(StatVille);
        //alert(StatVille);
        var j=0;
        var tab=[];
        var element={};

        $.each(donnee, function(key, value) {

            var test=0;
            element={};


            if(value['mois'])
            $.each(tab, function(key1, value1) {
                if(value1['mois']==value['mois'])
                {
                    tab[key1][value['libelle']]=value['nbr'];
                    test=1;
                }
            });
            if(test==0){
                element[value['libelle']]=value['nbr'];
                element['mois']=value['mois'];
                tab.push(element);
            }

            //console.log(element);
          //  alert(tab[0]);
        });
        //alert(tab[1]);
        console.log(tab);

            // ID of the element in which to draw the chart.
        Morris.Bar({
            element: 'containerStat',
            data: tab,
            xkey: 'mois',
            ykeys: ['Marrakech','Casablanca','Fes','Mohammedia','Agadir','Rabat'],
            labels: ['Marrakech','Casablanca','Fes','Mohammedia','Agadir','Rabat']
        });



    </script>

{% endblock %}